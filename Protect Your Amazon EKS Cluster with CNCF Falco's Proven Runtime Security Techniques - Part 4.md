# Protect Your Amazon EKS Cluster with CNCF Falco's Proven Runtime Security Techniques - Part 4

### **Creating Custom Amazon CloudWatch Insights**
To create custom insights and dashboards as per your requirement, navigate to Amazon CloudWatch Insights in the AWS Console. For this demonstration, we will create a custom dashboard named falco and add two insights based on the rules we have simulated thus far. 

For the first insight, we will create a query for the rule “mkdir binary dirs” and get the logs for the last three hours. The query will match any message in the logs that contain "mkdir binary dirs" and create a dashboard to display this information. Similarly, for the second insight, we will create a query for the rule "Read sensitive file untrusted" and get the logs for the last three hours. 

The query will match any message in the logs that contain "Read sensitive file untrusted" and create a dashboard to display this information. These custom dashboards can be useful in identifying patterns or anomalies in the logs, and can be used to investigate security incidents and take appropriate action.

![](images/image29.png)

![](images/image30.png)

As a final result, the dashboard for Falco should resemble the following sample screenshot.

![](images/image31.png)

### **Creating custom Amazon CloudWatch alarms**
In order to receive email alerts, create an Amazon SNS topic and subscription for email and grant the necessary permissions for sending emails.

Then, navigate to Amazon CloudWatch in the AWS Console and create an alarm according to the following instructions.

![](images/image32.png)

When setting up an alarm in Amazon CloudWatch, it's important to select the appropriate log group name and choose a suitable value for the statistic. In this demonstration, I have chosen to use the "Sum" statistic and set the threshold for alerts to one, which means that the Amazon CloudWatch Alarm will send an email notification when Falco sends at least one alert to Amazon CloudWatch. By setting the minimum alert threshold to one, you will receive alerts for all alerts generated by Falco.

It's important to note that the threshold value can be adjusted according to your requirements. For example, if you want to receive alerts only when there are multiple alerts, you can increase the threshold value. This way, you will only receive alerts when the number of alerts reaches your desired threshold. Additionally, you can also select different statistical values like average, minimum, maximum, etc. which will help you to receive alerts based on different statistical values.

![](images/image33.png)


![](images/image34.png)

Overall the alarm should look like the following screenshot:![](images/image35.png)

The CloudWatch alarm will send email alerts as below your email address mentioned: